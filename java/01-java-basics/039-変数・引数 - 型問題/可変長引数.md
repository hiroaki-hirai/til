# 可変長引数

# Q,

エントリーポイントのmainメソッドの引数に Stirng[] 型かString可変長型かどちらの使用も可能という認識です。
変数なら初期化のタイミングで上記2つの違いが出そうですが、引数の場合、初期化のタイミングが一緒になるように思うのでその違いが出ないのではないか？

ご質問の内容は非常に鋭く、Javaの`main`メソッドのシグネチャにおける「配列」と「可変長引数（varargs）」の違いが**引数として使用された場合に違いがあるかどうか**という点に焦点を当てています。以下に整理して解説します。

---

### ✅ 結論（先にまとめ）

- **`String[] args` と `String... args` は、mainメソッドの引数としてはほぼ同義です。**
- **どちらも、JVMからは「`String[]` 型の引数」として渡されます。**
- **したがって、mainメソッドの引数として使用される場合、両者の違いは**初期化の観点では**事実上存在しません。**

---

### 🔍 詳細解説

### ■ `main` メソッドの定義

Java のエントリーポイントである `main` メソッドの正式な定義は以下の通りです：

```java
public static void main(String[] args)
```

ですが、JVMは以下のシグネチャも認識します：

```java
public static void main(String... args)
```

### ■ 可変長引数 (`String... args`) の仕組み

可変長引数は、**コンパイル時に配列に変換される糖衣構文**です。以下は同義です：

```java
public static void main(String... args) { ... }
// ↓コンパイル後
public static void main(String[] args) { ... }
```

JVMが呼び出すときには、`main(String[] args)` というシグネチャでしか呼び出しません。つまり、**どちらも JVM の視点ではまったく同じ処理**になります。

---

### 🔄 「初期化のタイミング」に違いはあるか？

可変長引数と配列は、**呼び出し元がどう渡すかによって違いが出る**ものであり、`main` のように **JVMから自動で引数が与えられる場合**には違いは出ません。

- 可変長引数のメリットが出るのは、「呼び出す側で `,` 区切りで複数の引数を渡せる」ケースです。
- しかし `main` メソッドは自分で呼び出せないため、その可変長の恩恵を受けることは基本的にありません。

---

### ✅ 変数として使う場合の違い（参考）

```java
String[] array = {"a", "b", "c"};          // 配列の初期化
String... varargs = {"a", "b", "c"};       // NG：メソッド引数以外では使えない
```

- `String...` は **変数宣言** では使えません。
- 使用できるのは **メソッドのパラメータ** だけです。

したがって、「初期化のタイミングで差が出る」のは**変数として扱う場合に限定**され、`main`のようなパラメータとして扱う場合は差が出ません。

---

### 🧪 サンプルで確認

```java
public class Main {
    public static void main(String... args) {
        System.out.println(args.length);   // ← String[]として扱える
        for (String arg : args) {
            System.out.println(arg);
        }
    }
}
```

上記でも`String[] args`と同じように動作します。

---

### 🔚 結論（再掲）

> String[] args と String... args は、mainメソッドにおいては本質的に違いはありません。初期化のタイミングも、どちらもJVMによって同一のように扱われます。
> 

---

必要であれば、`varargs` と `配列` の違いを**通常メソッドにおける使用法**でも比較できますので、気軽にお知らせください。

# Q,

可変長引数が活用できるケースをコード例とともに示してください。

もちろんです！Javaにおける**可変長引数（varargs）**は、「引数の数が不定のメソッド」を作成したいときに非常に便利です。以下に典型的な活用例をコード付きで紹介します。

---

## ✅ 可変長引数が活用できるケースとコード例

---

### ① 任意の個数の数値を合計するメソッド

```java
public class VarargsExample {
    public static int sum(int... numbers) {
        int total = 0;
        for (int num : numbers) {
            total += num;
        }
        return total;
    }

    public static void main(String[] args) {
        System.out.println(sum(1, 2));           // 3
        System.out.println(sum(5, 10, 15, 20));  // 50
        System.out.println(sum());               // 0 ← 引数なしでもOK
    }
}
```

**ポイント**：

- 引数の数に応じて内部で自動的に `int[]` が作られます。
- 呼び出し側は「配列を意識せずに」複数の引数を並べて渡せます。

---

### ② 文字列を連結するメソッド

```java
public class VarargsExample {
    public static String join(String delimiter, String... elements) {
        if (elements.length == 0) return "";
        StringBuilder sb = new StringBuilder(elements[0]);
        for (int i = 1; i < elements.length; i++) {
            sb.append(delimiter).append(elements[i]);
        }
        return sb.toString();
    }

    public static void main(String[] args) {
        System.out.println(join(", ", "apple", "banana", "cherry"));
        // 出力: apple, banana, cherry

        System.out.println(join(" / ", "2025", "07", "20"));
        // 出力: 2025 / 07 / 20
    }
}
```

**ポイント**：

- 固定引数（`delimiter`）＋可変長引数の組み合わせも可能。
- 第一引数以降をまとめて受け取る設計にできる。

---

### ③ 複数の例外をまとめてハンドリングしたい場合（カスタムユーティリティ）

```java
public class VarargsExample {
    public static void checkNotNull(Object... objects) {
        for (Object obj : objects) {
            if (obj == null) {
                throw new IllegalArgumentException("引数にnullが含まれています");
            }
        }
    }

    public static void main(String[] args) {
        String a = "hello";
        String b = null;
        checkNotNull(a, "world", 123);     // OK
        checkNotNull(a, b);                // 例外が投げられる
    }
}
```

**ポイント**：

- 任意の数のオブジェクトを一括チェックできるユーティリティとして使える。

---

### 💡 可変長引数の注意点

- **複数の可変長引数は使えない**（1メソッドに1つだけ）
- **可変長引数は必ず最後のパラメータ**に置く必要がある

```java
// OK:
void print(String prefix, String... messages)

// NG:
// void print(String... messages, String suffix)
```

---

ご希望であれば、可変長引数の**配列との比較（可読性・使いやすさ）**や、**実務での使いどころ**なども補足できます！