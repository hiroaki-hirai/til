# コマンド

# Q,

classpathではなくモジュールシステムにおけるコマンドを列挙整理してください。

了解しました、Hiroakiさん。

ここでは **Javaのモジュールシステム（Java 9以降）に特化したコマンドとオプションを、目的別に整理**します。従来の `classpath` ではなく、**`--module-path` を中心としたモジュール構成で使用するコマンド群**になります。

---

# ✅ モジュールシステムにおけるコマンド・オプション一覧（目的別）

| 目的 | コマンド／オプション | 説明・用途 |
| --- | --- | --- |
| 🔧 **コンパイル** | `javac --module-source-path` | モジュール構造の `.java` ソースをパッケージ構造に基づいてビルド |
|  | `-d` | `.class` や `module-info.class` の出力先ディレクトリ（例：`mods/`） |
|  | `--module` | コンパイル対象とするモジュール名（複数指定可） |
|  | `--module-path` | 依存モジュールの `.class` がある場所（`mods/` 等）を指定 |
| ▶ **実行** | `java --module-path` | `.class` や `module-info.class` がある場所（モジュールの検索先）を指定 |
|  | `-m` または `--module` | モジュール名と実行対象クラス（完全修飾名）を `モジュール/クラス` 形式で指定 |
| 📦 **JAR 作成** | `jar --create --file` | `.class` や `module-info.class` を含んだモジュールJARを作成 |
|  | `--main-class` | モジュール内でデフォルトで実行されるメインクラスを指定 |
|  | `--module-version` | モジュールにバージョン情報を追加 |
| 🚀 **JAR 実行** | `java --module-path` `--module` または `-m` | JARファイルが含まれるモジュールパスを指定し、実行する |
|  | `java -p`（`-p` は `--module-path` の略） | 同じくモジュールの探索パスを指定する省略形 |
| 🔍 **依存関係の確認** | `jdeps --module-path` | JARやクラスが依存しているモジュールを表示 |
|  | `jdeps --module` | モジュール名で依存情報を確認 |
| 🧩 **サービスローダー** | `uses` / `provides with`（module-info.java内） | モジュール間のサービス提供／実装の登録（Java SPI的な仕組み） |

---

## 🔸 コマンド別・代表的な使用例

### ① コンパイル（複数モジュール）

```java
javac \
  --module-source-path src \
  -d mods \
  $(find src -name "*.java")
```

### ② 実行

```java
java \
  --module-path mods \
  -m com.example.myapp/com.example.myapp.Main
```

### ③ モジュールJAR作成

```java
jar --create \
    --file mods/com.example.myapp.jar \
    --main-class com.example.myapp.Main \
    -C mods/com.example.myapp .
```

### ④ jdepsでモジュール依存を確認

```java
jdeps \
  --module-path mods \
  --module com.example.myapp
```

---

## ✅ 用語・構造の整理

| 用語 | 内容 |
| --- | --- |
| `--module-path` | `.class` または `.jar` のモジュールファイル群を探す場所 |
| `--module-source-path` | `.java` ソースがあるディレクトリ。`module-info.java` も含まれる |
| `-m` | 実行時の指定。`<モジュール名>/<完全修飾クラス名>` |
| `module-info.java` | モジュールの名前・依存・公開範囲を定義する特別なファイル |

---

## ✅ まとめ：モジュールシステムのコマンド比較表

| コマンド | モジュール用オプション | 目的／役割 |
| --- | --- | --- |
| `javac` | `--module-source-path`, `-d`, `--module`, `--module-path` | ソースのモジュール構造を考慮してコンパイル |
| `java` | `--module-path`, `-m` | モジュール構成でアプリケーションを実行 |
| `jar` | `--create`, `--main-class`, `--module-version` | モジュールJARの作成 |
| `jdeps` | `--module`, `--module-path` | モジュール依存の可視化 |

---

ご希望であれば：

- `src → mods → jar → 実行` までのモジュール構成の手順
- `module-info.java` 付きの複数モジュール例
- モジュールと非モジュールの混在実行のコツ

などもご案内できます！どうされますか？

# Q,

上記に--describe-module や、jmod describe, --ad-exports, --show-module-resolutionなども加えてください。

承知しました。Hiroakiさんのリクエストに基づき、Javaのモジュールシステムに関わるコマンドやオプションを**より網羅的に**整理し直しました。特に以下を新たに追加しています：

- `-describe-module`
- `jmod describe`
- `-add-exports`（誤字修正：`-ad-exports` → `-add-exports`）
- `-show-module-resolution`

---

## 🧩 Javaモジュールシステム：コマンド＆オプション一覧【完全版】

---

### 🛠️ 1. `javac`（モジュールのコンパイル）

| オプション | 内容 |
| --- | --- |
| `--module` | 対象モジュールを指定 |
| `--module-source-path` | `モジュール名/パッケージ/クラス.java` 構造のソースディレクトリを指定 |
| `--module-path` | モジュールバイナリ（`.class`/`.jar`）を探すパス |
| `-d` | 出力ディレクトリ |
| `--add-exports <mod>/<pkg>=<target>` | 指定モジュールの非公開パッケージを一時的に外部公開 |

---

### 🚀 2. `java`（モジュールの実行）

| オプション | 内容 |
| --- | --- |
| `--module` or `-m` | `モジュール名/メインクラス名`を指定して実行 |
| `--module-path` | 実行時のモジュール探索パス |
| `--add-exports <mod>/<pkg>=<target>` | モジュールのパッケージを実行時に開放 |
| `--add-opens <mod>/<pkg>=<target>` | リフレクション用途などでパッケージを“開放” |
| `--patch-module <mod>=<dir or jar>` | モジュールにコードを差し込む（上書き） |
| `--show-module-resolution` | モジュール解決結果を表示（依存関係の確認に有用） |
| `--describe-module <mod>` | 指定モジュールの内容（exports, requiresなど）を表示 |

✅ 使用例：

```java
java --module-path mods -m com.example.app/com.example.app.Main
java --describe-module java.base
```

---

### 📦 3. `jar`（モジュールJARの作成）

| オプション | 内容 |
| --- | --- |
| `--create` / `-c` | JARの作成 |
| `--file` / `-f` | 出力ファイル名 |
| `--main-class` | 実行エントリポイント |
| `--module-version` | モジュールのバージョン番号付与 |

---

### 🧰 4. `jmod`（JMODファイル操作）

| サブコマンド | 内容 |
| --- | --- |
| `create` | JMODファイルの作成 |
| `describe` | JMODファイルの内容表示（依存、exportsなど） |
| `extract` | JMODファイルを展開 |
| `list` | JMODに含まれるファイル一覧を表示 |

✅ 使用例：

```java
jmod describe $JAVA_HOME/jmods/java.sql.jmod
```

---

### 🔎 5. `jdeps`（モジュール依存関係の分析）

| オプション | 内容 |
| --- | --- |
| `--module-path` | モジュール探索パス |
| `--module` | 対象モジュール名 |
| `--list-deps` | 直接依存しているモジュール一覧のみを表示 |
| `--print-module-deps` | コンパイルや実行に必要なモジュール名を列挙 |
| `--generate-module-info <出力先>` | 自動的に`module-info.java`の雛形を生成 |
| `--multi-release <version>` | マルチリリースJAR対応 |
| `--recursive` | 依存を再帰的に表示 |

✅ 使用例：

```java
jdeps --module-path mods --module com.example.app
```

---

### 🧱 6. `jlink`（カスタムJRE作成）

| オプション | 内容 |
| --- | --- |
| `--module-path` | モジュールの検索パス（JMOD推奨） |
| `--add-modules` | 含めるモジュール名（`,`区切り） |
| `--output` | 出力先ディレクトリ |
| `--strip-debug` | デバッグ情報を削除 |
| `--compress=0 | 1 |
| `--launcher` | エントリポイント付きランチャー作成 |

---

## 🧭 補足：オプションの比較表

| オプション | 対象 | 用途 |
| --- | --- | --- |
| `--module-path` | `javac`, `java`, `jlink`, `jdeps` | モジュール探索場所の指定 |
| `--add-exports` | `javac`, `java` | 指定パッケージを外部へ一時公開 |
| `--add-opens` | `java` | リフレクション対応向けのアクセス許可 |
| `--describe-module` | `java` | モジュールの構成内容（`exports`, `requires`）確認 |
| `--show-module-resolution` | `java` | モジュール解決の過程を可視化 |
| `--patch-module` | `java`, `javac` | テスト・修正目的でモジュールに差し込み |
| `jmod describe` | `jmod` | モジュールファイルの内部情報の確認 |

---

## 🎓 まとめ：目的別おすすめオプション

| 目的 | 推奨オプション／コマンド |
| --- | --- |
| モジュールを含めたコンパイル | `javac --module-source-path ... -m ...` |
| 実行時に依存関係を明示的に確認 | `java --show-module-resolution` |
| 特定モジュールの構成確認 | `java --describe-module` or `jmod describe` |
| 実行時の非公開APIにアクセス | `--add-exports`, `--add-opens` |
| モジュールにクラスを差し込む | `--patch-module` |
| モジュールからJRE作成 | `jlink --add-modules ... --output ...` |

---

必要であれば、**実プロジェクト構成を想定した実践フロー（例：複数モジュールの依存解決付き）** もご案内できます！お気軽にどうぞ。