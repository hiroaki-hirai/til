# API の互換性

# Q,

Java8以前のjava.lang もjava9以降のjava.langも同一のものだが、モジュールシステムのためにjava9以降のjava.langは、ラップされたようなイメージでしょうか？
それとも、Java8以前のjava.lang とjava9以降のjava.langは、それぞれ存在すし（２つ存在する）、それぞれのバージョンで管理のされ方が異なるというイメージでしょうか？

とても鋭く、深いご質問です、Hiroakiさん。

---

## ✅ 結論から先に：

> java.lang 自体は Java 8 以前も Java 9 以降も「同一のAPI」であり、別物が2つ存在するわけではありません。
> 
> 
> ただし、**Java 9以降ではこのパッケージ（`java.lang`）をモジュール（`java.base`）として"構造的に包んで"管理するようになった**というイメージが近いです。
> 

つまり：

> ✅ 中身は同じだが、外側（管理の枠組み）が変わった
> 
> 
> → Java 9以降は「モジュールという箱の中に `java.lang` が明示的に入った」
> 

---

## 🔍 たとえるなら…

- **Java 8 以前：** 部屋に本がそのまま床に並べて置かれていた
- **Java 9 以降：** 本をカテゴリごとの**本棚（モジュール）に整理した**

> java.lang という本は同じでも、「どう管理するか」が変わっただけです。
> 

---

## ✅ Java 8 vs Java 9以降 の `java.lang` 管理イメージ

| 観点 | Java 8 以前 | Java 9 以降 |
| --- | --- | --- |
| `java.lang.String` | クラスパスから直接使える | `java.base` モジュールが `exports java.lang;` している |
| 管理単位 | クラスパスベース（flat） | モジュールベース（階層＋依存関係あり） |
| 存在の重複 | ❌ 重複はない。同一のAPI | ✅ 同一のAPI。**モジュールにラップされた**だけ |
| ライブラリの中身 | `rt.jar` に全部まとまっていた（非公開） | `jmods/java.base.jmod` などに分割管理（モジュール単位） |
| 開発者が意識する構造 | クラス・パッケージ | モジュール・パッケージ・クラスの三層管理 |

---

## ✅ 技術的な裏付け（JDKファイル構成）

| Java 8 の場合 | Java 9以降の場合 |
| --- | --- |
| `jre/lib/rt.jar` | `jmods/java.base.jmod` などの `.jmod` ファイルに分割 |
| 全APIが1つのJARに固められていた | モジュールごとに分けて `exports`, `requires` で管理 |
| モジュール構成：❌ | モジュール構成：✅ `module-info.class` を含む |

---

## ✅ よくある誤解の整理

| 誤解（✗） | 正しい理解（✓） |
| --- | --- |
| Java 9では新しく `java.lang` が作られた | ✗ → いいえ。同じAPIです |
| Java 9以降はJava 8の `java.lang` とは互換がない | ✗ → 多くの部分で互換あり（ただし非公開APIなど一部は例外） |
| Java 9以降は `java.lang` がモジュールとして分割されている | ✓ → `java.base` モジュールの一部として管理されている |
| 2つの `java.lang` が並行して存在する | ✗ → 同じAPIが1つだけ。モジュール構造が付加されたイメージ |

---

## ✅ まとめ

| 項目 | 回答 |
| --- | --- |
| Java 8 と Java 9 の `java.lang` の中身は同一か？ | ✅ 同一API（違うものが2つ存在しているわけではない） |
| Java 9以降で変わったことは？ | ✅ `java.base` モジュールによる**構造的なラップ**が追加された |
| モジュールシステム導入の影響 | ✅ モジュール間の依存や公開範囲が制御可能になり、設計が明確になった |

---

ご希望があれば：

- `rt.jar` → `jmod` の変化
- `java.base` モジュールの中身を確認する方法（`jdeps`, `jar`）
- 非モジュールコードをモジュール対応させる具体例

なども解説できます！何か続けて知りたいことはありますか？