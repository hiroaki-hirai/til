# 構文ポイント

以下に、先ほどの「Java ひっかけ構文問題集」の**解答＋詳細な解説付きセット**をお届けします。

各問題で**なぜ引っかかるのか、どうすれば防げるのか**を明確にしています。

---

## ✅ Java ひっかけ構文問題集【解答＋解説付き】

---

### 【問1】この `if` 文の出力は？

```java
int x = 10;
if (x > 5)
    System.out.println("A");
    System.out.println("B");
```

**解答：A. A B**

**解説：**

- Javaでは `if` に続くのは1つの文だけ。
- 上のコードはこう解釈される：

```java
if (x > 5)
    System.out.println("A");
System.out.println("B"); // ← これは if に関係ない
```

- → 結果として両方出力される。

**防止策：** 常にブロック `{}` を使うべし。

---

### 【問2】この `while` 文の出力は？

```java
int i = 0;
while (i < 3)
    System.out.println(i);
    i++;
```

**解答：B. 無限ループ**

**解説：**

- `while` に従属するのは `System.out.println(i);` の1文のみ。
- `i++` は `while` の外にある → `i` はずっと 0 のまま → 永久ループ。

**防止策：** 複数行処理では必ず `{}` を使う。

---

### 【問3】`do-while` でどこまでループされるか？

```java
int i = 0;
do
    i++;
    System.out.println(i);
while (i < 3);
```

**解答：C. コンパイルエラー**

**解説：**

- `do` の本体としては `i++` しか認識されない。
- do - while 文はセットで使用するにも関わらず、do文単体で使用していることになりコンパイルエラーとなる。
- `System.out.println(i);` は文法的に `do` に属さず、独立していて `while` とつながらない → **構文エラー**

**正しい形：**

```java
do {
    i++;
    System.out.println(i);
} while (i < 3);
```

---

### 【問4】`if-else` の対応は？

```java
int x = 5;
if (x > 0)
    if (x > 10)
        System.out.println("A");
    else
        System.out.println("B");
```

**解答：B. B**

**解説：**

- Javaでは `else` は **直前の `if` に結びつく**（"dangling else" 問題）。
- `if (x > 0)` の中に `if (x > 10) ... else ...` が入っている。
- `x = 5` なので `x > 10` は false → `else` に入って "B" が出力される。

**防止策：** ネストされた `if` には必ず `{}` をつける。

---

### 【問5】複文がない `for` 文の動作は？

```java
for (int i = 0; i < 2; i++)
    System.out.println("A");
    System.out.println("B");
```

**解答：A. A A B**

**解説：**

- `for` ループに従属しているのは `System.out.println("A");` のみ。
- `System.out.println("B");` はループの外にあるため、1回だけ実行される。

**正しい複文にするには：**

```java
for (int i = 0; i < 2; i++) {
    System.out.println("A");
    System.out.println("B");
}
```

---

### 【問6】次の `switch` 文の出力は？

```java
int x = 2;
switch (x) {
    case 1:
        System.out.println("A");
    case 2:
        System.out.println("B");
    default:
        System.out.println("C");
}
```

**解答：B. B C**

**解説：**

- `case 2:` にマッチ → "B" 出力
- **`break` がないため** → `default:` にも貫通し "C" も出力

**防止策：** `break;` を明示的に書く

---

### 【問7】セミコロンで何が起きる？

```java
int x = 0;
if (x == 0);
    System.out.println("A");
```

**解答：A. A が表示される**

**解説：**

- `if (x == 0);` のセミコロンは「空文」として処理される。
- `if` の条件にかかわらず、次の文（`System.out.println("A");`）が常に実行される。

**防止策：** `if` の直後にセミコロンを書かないよう注意！

---

## ✅ 総まとめ：よくあるひっかけを避けるコツ

| 状況 | 安全な書き方 |
| --- | --- |
| 単文か複文かわかりにくいとき | 常に `{}` を使う |
| `else` がどの `if` に属するか不安 | ネストされた `if` にも `{}` を使う |
| `do-while` の構文が不安 | `{}` で囲んで処理を明確に |
| `switch` の貫通が心配 | `break;` を忘れずに |
| セミコロンの位置が微妙 | `if(...) ;` は危険なので避ける |

# Q, do-while 文について

これは、本来do文とwhile文はセットであるにもかかわらず、分離していることでdo文単体で記載していることになるのでコンパイルエラーとなるという認識は合っていますか？

```java
int a = 0;
do {
    a++;
    System.out.println(a);
} while (a < 5);
```

---

## ✅ 結論

> do 文と while は本来セットで1つの構文であり、
> 
> 
> **構文上で分離されているように見えると、`do` 文が不完全と解釈され、コンパイルエラーになる**という理解は**正しい**です。
> 

---

## 🔍 詳しい解説

### Javaの構文ルール（do-while）

```java
do {
    // 処理
} while (条件);
```

- `do` と `while (...) ;` はセットで **1つの DoStatement**
- **このペアが揃っていないと、Javaコンパイラは「未完の do 文」と判断し、エラーを出します**

---

### ❌ エラーになる構文の例

```java
int a = 0;
do
    a++;
    System.out.println(a); // ← ここで "do" 文が終わったと誤解される
while (a < 5);
```

- `do` に対して**1文しか従属できない**のに、2文書かれている（`a++` と `println(a)`）
- そのため、`while (...)` はもはや `do` に対応するものではないと判断される
- 結果、**`do` に対応する `while` が存在しない＝構文未完了 → コンパイルエラー**

---

## ✅ ポイントの整理

> 🔹 「複数文を1つの文として扱えない構文に、ブロックなしで複数文を記述した場合」には構文エラー（＝コンパイルエラー）になる
> 
> 
> 🔹 特に、**構文的にペアで完結している必要がある構文（`do-while`, `try-catch-finally`, `if-else` など）**で起きやすい
> 

---

## ✅ コンパイルエラーになる構文例（do-while以外）

以下に代表的なパターンを紹介します。

---

### 🔴 1. `try` 文（`try` の本体に複数文をブロックなしで書く）

```java
try
    System.out.println("A");
    System.out.println("B"); // ← エラー
catch (Exception e) {
    System.out.println("error");
}
```

**⛔ 結果：コンパイルエラー**

### ✅ 正しい形：

```java
try {
    System.out.println("A");
    System.out.println("B");
} catch (Exception e) {
    System.out.println("error");
}
```

---

### 🔴 2. `if-else` 文の誤対応（省略＋ネスト）

```java
int x = 5;
if (x > 0)
    if (x > 10)
        System.out.println("A");
    else
        System.out.println("B"); // ← どの if に対応するか曖昧（構文上はOKでも危険）
```

- *⚠️ 結果：構文エラーにはならないが、**意味が非常に分かりにくくなり**、バグを生みやすい。`else` を誤って外の `if` に対応させると構文エラーになることもある。

### ✅ 安全な書き方：

```java
if (x > 0) {
    if (x > 10) {
        System.out.println("A");
    } else {
        System.out.println("B");
    }
}
```

---

### 🔴 3. ラムダ式（省略して複数文書く）

```java
Runnable r = () -> 
    System.out.println("A");
    System.out.println("B"); // ← エラー
```

**⛔ 結果：コンパイルエラー**

### ✅ 正しい形：

```java
Runnable r = () -> {
    System.out.println("A");
    System.out.println("B");
};
```

---

## ✅ まとめ表：ブロックなしで複数文を記載するとエラーになる主な構文

| 構文 | ブロック省略で複数文書くとどうなるか | 対応方法 |
| --- | --- | --- |
| `do-while` | ❌ コンパイルエラー | `{}` で囲む |
| `try` / `catch` / `finally` | ❌ コンパイルエラー | `{}` で囲む |
| ラムダ式（複数文） | ❌ コンパイルエラー | `{}` を使用 |
| `if-else`（ネスト時） | ⚠️ 構文エラーにならないが誤動作しやすい | `{}` で明示的に囲む |

以下に、Javaで特に注意が必要な「**文法解析上の落とし穴（構文トラップ集）**」を一覧にしてお届けします。

**コンパイルは通るが誤動作するもの、構文エラーになるもの、読み間違えやすい構造**など、試験・実務でひっかかりやすいものを網羅しています。

---

# ✅ Java 構文トラップ集：文法解析上の落とし穴 一

| No. | 構文 | 落とし穴の例 | 結果 | 解説・対策 |
| --- | --- | --- | --- | --- |
| 1 | `if` | `if (x > 0);` | ✅ 実行される（空文） | セミコロンで空文を実行、次の処理が常に実行される。→ `{}` 明示推奨 |
| 2 | `if-else` | ネストして else がどの if に属するかわからない | ⚠️ 意図しない `else` 対応 | 「dangling else」問題。ブロック `{}` 明示で防止 |
| 3 | `for`, `while` | 複数文をブロックなしで記載 | ⚠️ 2文目はループ外 | セミコロンや `{}` を省略するとロジックバグに。常にブロック化推奨 |
| 4 | `do-while` | 本体に複数文をブロックなしで記述 | ❌ コンパイルエラー | `do` に文が1つしか書けない。複文は必ず `{}` で囲む |
| 5 | `switch` | `break` を忘れる | ⚠️ 意図せず case が貫通 | 明示的に `break` を記述しないと次の case に流れる（fall-through） |
| 6 | `try-catch` | `try` に複数文を `{}` なしで書く | ❌ コンパイルエラー | `try` には必ずブロックが必要。文1つでも `{}` が原則 |
| 7 | ラムダ式 | `()->` に複数文を `{}` なしで書く | ❌ コンパイルエラー | 複数文は必ず `{}` を使い、戻り値がある場合は `return` も必要 |
| 8 | 空文 | `while (true);` | ⚠️ 無限ループ | セミコロン1つで「何もしない」ループに。処理なしの空ループに注意 |
| 9 | セミコロンの位置 | `if (cond);` や `for (init; cond; inc);` | ✅ 動作はするが意図とズレる | 意図せぬ空文によって、次の処理が常に実行される・無視されるなどバグ誘発 |
| 10 | ラベル付き文 | `break label;` のスコープミス | ❌ コンパイルエラー | ラベル文法は正しいスコープ内で使用しないとエラー。基本的に非推奨 |

---

## 🔍 トラップの分類と覚え方

| カテゴリ | 主なトラップ | 原因 | 予防策 |
| --- | --- | --- | --- |
| 単文 vs 複文の誤解 | `if`, `while`, `do`, `for` | 1文しか認識されない構文 | **常に `{}` を使う** |
| セミコロンの誤配置 | `if (cond);` / `while (cond);` | 空文と解釈されて実行される | 条件後のセミコロン禁止 |
| ブロック必須構文 | `do-while`, `try`, `lambda` | 複文があるのにブロックなし | 複数文なら必ず `{}` |
| 暗黙の構文貫通 | `switch`, `if-else` | 明確な区切りがない | `break` や `{}` を明示 |