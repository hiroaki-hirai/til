# 代入演算子まとめ

以下に、**Java Silver試験でひっかけられやすい「代入演算子（=、+=、-=、*=、/= など）」に関する問題集**を用意しました。

すべて**「コンパイルが通るかどうか」「結果は何になるか」**という観点で、**型の昇格・キャストの罠**を含めた構成です。

---

## ✅ Java 代入演算子パターン問題集（型昇格・キャスト含む）

---

### ❶ 【基本代入：OKなパターン】

```java
int a = 5;
a = a + 2;
System.out.println(a);
```

**Q: コンパイルは通るか？ 出力結果は？**

✅ 答え：**通る / 7**

**理由**：`int + int = int`。代入先も `int` のため問題なし。

---

### ❷ 【byteと代入演算子（+=）】

```java
byte b = 10;
b = b + 1;
```

**Q: コンパイルは通るか？**

❌ 答え：**通らない**

**理由**：`byte + int → int` に昇格 → `byte` への代入は縮小変換 → 明示キャストが必要。

✅ 修正例：

```java
b = (byte)(b + 1);
```

---

### ❸ 【byteと複合代入（+=）】

```java
byte b = 10;
b += 1;
```

**Q: コンパイルは通るか？**

✅ 答え：**通る**

**理由**：`+=` などの**複合代入演算子は内部で暗黙キャスト**されるためOK。

---

### ❹ 【charと加算】

```java
char c = 'A';
c = c + 1;
```

**Q: コンパイルは通るか？**

❌ 答え：**通らない**

**理由**：`char + int → int` になるため、`char` への代入に明示キャストが必要。

---

### ❺ 【charと+=】

```java
char c = 'A';
c += 1;
System.out.println(c);
```

**Q: コンパイルは通るか？ 出力は？**

✅ 答え：**通る / B**

**理由**：`+=` により暗黙キャストが行われるためOK。'A' + 1 → 'B'

---

### ❻ 【floatとintの複合代入】

```java
float f = 3.5f;
f += 2;  // 2はintリテラル
```

**Q: コンパイルは通るか？**

✅ 答え：**通る**

**理由**：`int` は `float` へ拡大変換可能。`+=` はキャストも含む。

---

### ❼ 【longとintの代入】

```java
long l = 1000;
l = l + 2000000000;
```

この文は **正しくコンパイルされ、`1000` は自動的に `long` に拡大変換されます**。

**`1000` は `int` リテラル**ですが、`long` 型変数に代入される際に **拡大変換（widening conversion）** が行われるため、**明示的に `1000L` と書かなくてもOK**です。

---

## 🔍 解説：整数リテラルの型のルール

| リテラル例 | 型 | 備考 |
| --- | --- | --- |
| `1000` | `int` | デフォルトで int |
| `1000L` or `1000l` | `long` | 明示的に long にしたい場合 |
| `10000000000` | エラー | `int` の範囲を超える → `L` 必要 |

---

## ❌ 注意が必要なケース

```java
long l = 10000000000;  // ❌ コンパイルエラー
```

- `10000000000` は `int` リテラルとして解釈されるが、`int` の最大値（2,147,483,647）を超えているためエラー。
- **解決方法：**

```java
long l = 10000000000L;  // ✅ OK
```

---

## ✅ 正しく理解しておくべきこと

- `long l = 1000;` は OK（**int → long の拡大変換が自動で行われる**）
- **リテラルが int の範囲内**なら、`long` に代入するために `L` は不要
- ただし、**リテラルが int の範囲を超える場合**は `L` を付ける必要がある

---

### 🧠 補足：リテラルに `L` をつけるメリット（明示性）

実務では以下のように **意図が明確になるため、`L` をつける習慣**が推奨されることもあります。

```java
long timeout = 3000L;  // 明示的でわかりやすい
```

---

### ❽ 【int += double のパターン】

```java
int i = 5;
i += 2.5;
```

**Q: コンパイルは通るか？**

❌ 答え：**通らない**

**理由**：`i + 2.5` の結果は `double`。`+=` の場合でも **戻り値がdouble → intに戻せない**。

---

### ❾ 【doubleとfloatの複合演算】

```java
float f = 1.0f;
f += 2.5;
```

**Q: コンパイルは通るか？**

❌ 答え：**通らない**

**理由**：`2.5` は `double`。`float += double` は暗黙キャストされない。

✅ 修正例：

```java
f += 2.5f;
```

---

### 🔟 【final変数に対して+=】

```java
final int x = 10;
x += 5;
```

**Q: コンパイルは通るか？**

❌ 答え：**通らない**

**理由**：`final` 変数は再代入不可。`+=` は代入と同義なのでNG。

---

## ✅ 重要な知識まとめ：複合代入（+= など）の挙動

| 式の種類 | 通常代入 (`a = a + b`) | 複合代入 (`a += b`) | 解説 |
| --- | --- | --- | --- |
| `byte + int` | ❌ コンパイルエラー | ✅ OK（暗黙キャスト） | 複合代入は内部でキャストされる |
| `char + int` | ❌ | ✅ | 同上 |
| `int + double` → int型変数 | ❌ | ❌ | 精度が落ちる可能性があるため許可されない |