# 検査例外・非検査例外

# Q,

選択的に検査例外か非検査例外となる場合、検査例外の可能性があるので必ずその旨をthrowsしなくてはならない認識はあっていますか？

はい、Hiroakiさん、その認識は **完全に正しい** です。

---

## ✅ 結論：

> 検査例外（checked exception）として扱われる可能性がある場合、その例外を throws に明示しなければ、コンパイルエラーになります。
> 

たとえ実行時にその例外が「発生しない」コードであっても、

**呼び出しているメソッドが検査例外をスローする可能性がある限り、呼び出し側では `throws` で宣言するか `try-catch` で処理する必要があります。**

---

## 🔍 なぜこのルールがあるのか？

Javaの検査例外の目的は：

- **外部環境依存の失敗（I/O・DB・ネットワークなど）に対して明示的に対応を強制すること**
- コード上で「例外の可能性があること」を見える形で示すこと

です。

---

## ✅ 例：検査例外の「可能性がある」コード

```java
public void readFile() throws IOException {
    Files.readAllLines(Path.of("sample.txt")); // ← IOException の可能性あり
}
```

➡ `IOException` は **検査例外**

➡ `readAllLines()` の内部で **IOException を throws している**

➡ 呼び出し元でも **throws IOException が必須**（書かないとコンパイルエラー）

---

## 🔹「実際には発生しない」場合でも必要か？

はい、必要です。

```java
public void safe() throws IOException {
    Path p = Path.of("already-exists.txt");
    if (Files.exists(p)) {
        // 実際にはIOExceptionは起きないとしても
        Files.readAllLines(p); // ← throws IOException の可能性がある
    }
}
```

➡ コンパイル時点では例外が起きるかどうかは分からないため、**宣言が強制されます。**

---

## ✅ まとめ

| 観点 | 結論 |
| --- | --- |
| 例外が「検査例外」の可能性がある場合 | ✅ 必ず `throws` で宣言 or `try-catch` で処理が必要 |
| 実行時にその例外が起きない場合でも | ✅ コンパイル時に要求されるので `throws` は必要 |
| 例外が非検査例外である可能性しかない場合 | ❌ `throws` は不要（書いてもいいが強制ではない） |

---

## ✅ Hiroakiさんのご認識の整理

> 「選択的に検査例外か非検査例外となる場合、検査例外の可能性があるなら必ず throws する必要がある」
> 

➡ **はい、その認識は正確です。**

---

もしご希望があれば：

- Javaの代表的な検査例外／非検査例外の分類表
- throws と try-catch の使い分けパターン
- Eclipseで「throws を忘れた時のエラーと補完アクション」なども紹介できます！

必要があればお知らせください。

# Q,

上記の場合、catch 文に検査例外の場合の処理を記載しなくても問題ない認識は合っていますか？

はい、Hiroakiさん、**その認識は概ね正しいです。**

ただし、**catch に書かない場合には、代わりに `throws` で宣言する必要がある**という前提付きです。

---

## ✅ 結論：

> 検査例外が発生する可能性があるコードについて、catch 文で処理しなくても構いません。
> 
> 
> ただし、**その場合はメソッド宣言に `throws` を記述しておく必要があります。**
> 

---

## 🔍 例で比較

### ✅ パターン1：`throws` を使う（catch なし）

```java
public void readFile() throws IOException {
    // 検査例外の可能性がある
    Files.readAllLines(Path.of("sample.txt"));
}
```

➡ **catch は不要**。例外は呼び出し元に「投げる（伝える）」ことになる。

---

### ✅ パターン2：`try-catch` で処理する（throws なし）

```java
public void readFile() {
    try {
        Files.readAllLines(Path.of("sample.txt"));
    } catch (IOException e) {
        System.out.println("ファイル読み込みに失敗しました");
    }
}
```

➡ 例外を自分で処理するので `throws` は不要。

---

### ❌ パターン3：catch も throws もなし → **コンパイルエラー**

```java
public void readFile() {
    Files.readAllLines(Path.of("sample.txt")); // ← コンパイルエラー
}
```

➡ `IOException` を処理していないため、**エラーになります。**

---

## ✅ ポイントまとめ

| 処理方法 | `catch` 必要？ | `throws` 必要？ | 説明 |
| --- | --- | --- | --- |
| 自分で処理する | ✅ はい | ❌ いいえ | try-catchで例外を処理して完結 |
| 呼び出し元に投げる | ❌ いいえ | ✅ はい | `throws` で上位に例外を伝える |
| どちらもしない | ❌ 不可 | ❌ 不可 | コンパイルエラーになる（必ず対処が必要） |

---

## ✅ Hiroakiさんのご質問への答え

> 「catch文に書かなくてもよいか？」
> 

→ **はい、`throws` を正しく書いていれば問題ありません。**

→ **ただし「何もしない（catch も throws も書かない）」のは NG です。**

---

ご希望があれば：

- `throws` を使った例外伝播のトレース例
- IDEで「try-catch に変換」や「throws に変換」する自動操作の紹介
- `try-with-resources` を含めたスマートな例外処理

などもご案内できます！さらに続けますか？

# Q,

非検査例外の場合も、検査例外の場合も基本的に catchで処理する必要な無いが、検査例外の場合は、必ずその旨を throwsするか、catchにて記述する必要がある認識はあっていますか？

はい、Hiroakiさん、**その認識は正確です。**

---

## ✅ 結論

> 非検査例外（unchecked exception）：
  → catch も throws も書かなくてもOK（処理は任意）検査例外（checked exception）：
  → catch するか throws で必ず明示的に宣言しなければコンパイルエラーになる
> 

つまり：

> ✅ 検査例外は「明示的な対応が義務」だが、処理方法（catch か throws）は自由
> 
> 
> ❌ **非検査例外は、明示も処理も義務ではない**
> 

---

## 🔍 例で整理

### ✅ 非検査例外の例（`NullPointerException`）

```java
public void run() {
    String s = null;
    s.length(); // NullPointerException が起きる可能性がある
}
```

- `throws` も `catch` も不要
- 発生したらそのままアプリが落ちるが、**コンパイルは通る**

---

### ✅ 検査例外の例（`IOException`）

```java
public void readFile() throws IOException {
    Files.readAllLines(Path.of("sample.txt")); // ← 検査例外の可能性あり
}
```

- `throws IOException` を書かないと **コンパイルエラーになる**
- または以下のように `try-catch` しても OK：

```java
public void readFile() {
    try {
        Files.readAllLines(Path.of("sample.txt"));
    } catch (IOException e) {
        System.out.println("読み込み失敗");
    }
}
```

---

## ✅ まとめ表

| 例外の種類 | `catch` 必須か？ | `throws` 必須か？ | コンパイル時の強制 |
| --- | --- | --- | --- |
| **非検査例外** | ❌ 不要（任意） | ❌ 不要（任意） | ✅ なし（自由に書ける） |
| **検査例外** | ❌ 任意 | ✅ 必須（または `catch`） | ❌ 書かないと**コンパイルエラー** |

---

## ✅ Hiroakiさんの認識を言い換えると：

> 🔸「catch は任意。
> 
> 
> でも検査例外は、**明示的に何らかの形で処理が必要（catch または throws）**」
> 

➡ ✅ **完全に正しいです。**

---

ご希望があれば：

- よく使う検査例外／非検査例外の分類早見表
- Eclipse で try-catch / throws に変換するショートカット
- 例外設計におけるベストプラクティス

なども提供できます！お気軽にどうぞ。