# final フィールド

# Q,

public Sample() {}
上記のコンストラクタがコンパイルエラーになる場合はありますか？
フィールドがfinalで定数化してあり、他に引数ありのコンストラクタのオーバーロードがある場合などです。

とても良い質問です！

結論からいうと：

---

## ✅ `public Sample() {}` が **コンパイルエラーになるケースは存在します**。

特に、**初期化されていない `final` フィールドがある場合**は要注意です。

---

## 🔥 コンパイルエラーになる典型的なケース

```java
public class Sample {
    private final int value; // final フィールド（初期化必須）

    public Sample() {
        // ❌ コンパイルエラー！
        // final フィールド value が初期化されていない
    }

    public Sample(int v) {
        this.value = v; // ✅ こちらでは初期化されている
    }
}
```

### ⚠️ エラーメッセージ（例）:

```java
variable value might not have been initialized
```

---

## ✅ なぜエラーになるのか？

Javaの仕様では、`final` フィールドは：

- **宣言時**
- **すべてのコンストラクタの中**
    
    のいずれかで、**必ず1回だけ初期化されていなければならない**。
    

上記の例では `Sample()` の中で `value` が設定されていないため、

> 「value は未初期化のままインスタンスが作られてしまう可能性がある」
> 
> 
> と判断されて **コンパイルエラー** になります。
> 

---

## ✅ エラーを避けるためには？

### 方法1：フィールド宣言時に初期化する

```java
private final int value = 0; // どのコンストラクタでも初期化済み
```

### 方法2：すべてのコンストラクタ内で初期化する

```java
public Sample() {
    this.value = 0;
}

public Sample(int v) {
    this.value = v;
}
```

---

## ✅ まとめ

| 条件 | `public Sample() {}` がコンパイルエラーになるか？ |
| --- | --- |
| finalフィールドがあり、かつ初期化されていない | ✅ エラーになる |
| finalフィールドを宣言時またはコンストラクタ内で初期化 | ❌ 問題なし |
| finalフィールドが存在しない | ❌ 問題なし |

---

もし「`final` を効果的に使う設計」や「不変オブジェクト（immutable）の作り方」にも興味があれば、そちらにもつなげられますよ！

# Q,

上記の場合、エントリーポイントにてデフォルトのコンストラクタが呼ばれれば、finalであってもデフォルト値で初期化されることはないのでしょうか？

はい、Hiroakiさんの問いかけはとても本質的で、

**結論から言うと：**

---

## ❌ **finalフィールドには、たとえプリミティブ型であっても「デフォルト値（0やnull）」は自動的には入りません。**

> Javaでは、finalフィールドは「開発者が明示的に初期化する」ことがコンパイル要件です。
> 
> 
> デフォルトコンストラクタであっても、自動で初期化されることは**ありません**。
> 

---

## 🔍 比較：通常のフィールド vs `final`フィールド

### ✅ 通常のフィールド（非final）

```java
public class A {
    int num; // 初期化しなくてもOK（自動で 0 が入る）

    public static void main(String[] args) {
        A a = new A();
        System.out.println(a.num); // → 0
    }
}
```

- Javaではインスタンスのプリミティブ型フィールドには、自動的にデフォルト値が入ります。
    - `int → 0`
    - `boolean → false`
    - `Object → null`

---

### ❌ `final`フィールドの場合（デフォルト値は入らない）

```java
public class B {
    final int num; // 初期化必須！

    public B() {
        // num を初期化しない → コンパイルエラー！
    }
}
```

### ⚠️ エラーメッセージ：

```java
variable num might not have been initialized
```

- デフォルト値（0）は**代入ではない**ので、**final要件を満たさない**。
- *「一度だけ明示的に代入」**されていなければならないのが`final`のルール。

---

## ✅ 初期化の正しい方法

### ① 宣言時に初期化

```java
final int num = 42;
```

### ② コンストラクタで初期化（すべてのコンストラクタで！）

```java
final int num;

public B() {
    this.num = 10;
}
```

---

## ✅ まとめ

| 状況 | 初期化されるか | 説明 |
| --- | --- | --- |
| 非finalフィールド（int num;） | ✅ デフォルトで 0 が代入される |  |
| finalフィールド（final int num;） | ❌ デフォルト値は**代入されず** → **コンパイルエラー** |  |

---

この特性は「不変オブジェクト設計」や「スレッドセーフなクラス設計」にとても重要です。

もしそのあたりにも興味があれば、一緒に掘り下げていけますよ！